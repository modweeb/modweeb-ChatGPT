<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مولد الصور المصغرة للمدونات</title>
<style>
    :root {
        --contentL: #e0e0e0;
        --contentB: #ffffff;
        --notifB: #f8f9fa;
        --linkC: #4a6fa5;
        --textColor: #333333;
        
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --radius-sm: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
    }
    
    .heroBox {
        margin: 0 auto;
    }
    
    .BoxTool {
        background: var(--contentB);
        border-radius: var(--radius-lg);
        overflow: hidden;
        box-shadow: var(--shadow-lg);
    }
    
    .thumbnail-generator-container {
        padding: 30px;
    }
    
    .icon {
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}
    
    .container {
        display: flex;
        flex-direction: column;
        gap: 30px;
    }
    
    .title {
        font-size: 24px;
        font-weight: 700;
        
        margin-bottom: 20px;
    }
    
    .editor {
        display: flex;
        flex-direction: column;
        gap: 30px;
    }
    
    /* شريط التبويبات الأفقي المطور */
    .settings-tabs {
        display: flex;
        background: var(--notifB);
        border-radius: var(--radius-md);
        padding: 6px;
        margin-bottom: 25px;
        position: relative;
        overflow: hidden;
        box-shadow: var(--shadow-sm);
        gap: 1px;
    }

    .tab-btn {
        flex: 1;
        min-width: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 16px;
        background: transparent;
        border: none;
        border-radius: var(--radius-sm);
        cursor: pointer;
        font-weight: 600;
        
        transition: var(--transition);
        position: relative;
        z-index: 1;
        white-space: nowrap;
        margin: 0 1px;
    }

    /* الخط الفاصل المعدل */
    .tab-btn:not(:last-child)::after {
        content: '';
        position: absolute;
        right: -1px;
        top: 50%;
        transform: translateY(-50%);
        height: 60%;
        width: 1px;
        background: rgba(0, 0, 0, 0.1);
        box-shadow: 1px 0 1px rgba(255, 255, 255, 0.5);
    }
    
    .tab-btn:hover {
        color: var(--linkC);
    }
    
    .tab-btn.active {
        color: var(--linkC);
        background: var(--contentB);
        box-shadow: var(--shadow-sm);
    }

    /* محتوى التبويبات */
    .tab-content {
        display: none;
        animation: fadeIn 0.4s ease-out;
    }
    
    .tab-content.active {
        display: block;
    }
    
    .form-section {
        background: var(--contentB);
        border-radius: var(--radius-md);
        padding: 20px;
        margin-bottom: 25px;
        border: 1px solid var(--contentL);
        box-shadow: var(--shadow-sm);
    }
    
    .form-group {
        margin-bottom: 18px;
    }
    
    .form-group label {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
        font-weight: 600;
        
    }
    
    input, textarea, select {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid var(--contentL);
        border-radius: var(--radius-sm);
        font-size: 15px;
        transition: var(--transition);
        background: var(--contentB);
    }
    
    input:focus, textarea:focus, select:focus {
        outline: none;
        border-color: var(--linkC);
        box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
    }
    
    textarea {
        min-height: 100px;
        resize: vertical;
    }
    
    /* أزرار الراديو والاختيار */
    .radio-group {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 8px;
    }
    
    .radio-option {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        padding: 8px 12px;
        border-radius: var(--radius-sm);
        transition: var(--transition);
    }
    
    .radio-option:hover {
        background: rgba(74, 111, 165, 0.1);
    }
    
    .radio-option input {
        width: auto;
    }
    
    /* ألوان ومحددات */
    .color-picker-group {
        display: flex;
        gap: 15px;
        margin-top: 15px;
    }
    
    .color-picker {
        flex: 1;
    }
    
    .color-picker label {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
    }
    
    .color-picker input[type="color"] {
        height: 45px;
        padding: 3px;
        cursor: pointer;
        border-radius: var(--radius-sm);
        border: 1px solid var(--contentL);
    }
    
    /* أنماط الزخرفة */
    .tb-pattern-options {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(40px, 3fr));
        gap: 15px;
        margin-top: 15px;
    }
    
    .tb-pattern-option {
        aspect-ratio: 1/1;
        border-radius: var(--radius-sm);
        border: 2px solid transparent;
        cursor: pointer;
        overflow: hidden;
        transition: var(--transition);
        background-color: var(--contentB);
        background-size: cover;
        box-shadow: var(--shadow-sm);
    }
    
    .tb-pattern-option:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
    }
    
    .tb-pattern-option.selected {
        border-color: var(--linkC);
        box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.3);
    }
    
    /* معاينات الإطارات */
    .frame-options {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 15px;
        margin-top: 15px;
    }
    
    .frame-option {
        cursor: pointer;
        transition: var(--transition);
    }
    
    .frame-option:hover {
        transform: translateY(-3px);
    }
    
    .frame-option.selected {
        transform: scale(1.05);
    }
    
    .frame-preview {
        aspect-ratio: 16/9;
        border-radius: var(--radius-sm);
        background-size: cover;
        border: 1px solid var(--contentL);
        background-color: var(--contentB);
        box-shadow: var(--shadow-sm);
    }
    
    .frame-name {
        text-align: center;
        margin-top: 8px;
        font-weight: 500;
        font-size: 14px;
    }
    
    /* أزرار التحكم في الحجم */
    .size-control-group {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 15px 0;
    }
    
    .size-control-group label {
        min-width: 100px;
        font-weight: 600;
    }
    
    .size-controls {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .size-btn {
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-sm);
        background: rgba(74, 111, 165, 0.1);
        color: var(--linkC);
        border: none;
        cursor: pointer;
        transition: var(--transition);
    }
    
    .size-btn:hover {
        background: var(--linkC);
        color: white;
    }
    
    .size-value {
        min-width: 40px;
        text-align: center;
    }
    
    /* الأزرار */
    .actions-section {
        background: rgba(74, 111, 165, 0.05);
        border: 1px solid rgba(74, 111, 165, 0.1);
        border-radius: var(--radius-md);
    }
    
    .tb-buttons {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
    }
    
    /* أزرار التحميل */
    .tb-download-options {
        display: flex;
        gap: 8px;
        margin-bottom: 20px;
        flex-wrap: wrap;
        justify-content: center;
    }

    @media (min-width: 768px) {
        .tb-download-options {
            justify-content: center;
            flex-wrap: nowrap;
        }
    }
    
    .tb-button {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px 24px;
        border: none;
        border-radius: var(--radius-sm);
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
    }
    
    .primary-btn {
        background: var(--linkC);
        color: white;
    }
    
    .primary-btn:hover {
        background: #3a5a8a;
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }
    
    .secondary-btn {
        background: var(--linkC);
        color: white;
    }
    
    .secondary-btn:hover {
        background: rgba(74, 111, 165, 0.1);
    }
    
    .danger-btn {
        background: var(--linkC);
        color: white;
    }
    
    .danger-btn:hover {
        background: rgba(231, 76, 60, 0.1);
    }
    
    .preview-container {
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-grow: 1;
        background: var(--notifB);
        position: relative;
    }
    
    .preview-controls {
        display: flex;
        justify-content: center;
        gap: 10px;
        padding: 15px;
        background: var(--contentB);
        border-top: 1px solid var(--contentL);
    }
    
    .preview-control-btn {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(74, 111, 165, 0.1);
        color: var(--linkC);
        border: none;
        cursor: pointer;
        transition: var(--transition);
    }
    
    .preview-control-btn:hover {
        background: var(--linkC);
        color: var(--contentB);
    }
    
    #thumbnailCanvas {
        max-width: 100%;
        height: auto;
        border-radius: var(--radius-sm);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        background: var(--contentB);
        border: 1px solid var(--contentL);
        transition: var(--transition);
    }
    
    .canvas-wrapper {
        position: relative;
        display: inline-block;
        box-shadow: var(--shadow-lg);
        border-radius: var(--radius-sm);
        overflow: hidden;
    }
    
    .canvas-actions {
        position: absolute;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        opacity: 0;
        transition: var(--transition);
    }
    
    .canvas-wrapper:hover .canvas-actions {
        opacity: 1;
    }
    
    .canvas-action-btn {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.7);
        color: var(--contentB);
        border: none;
        cursor: pointer;
        transition: var(--transition);
        backdrop-filter: blur(5px);
    }
    
    .canvas-action-btn:hover {
        background: var(--linkC);
        transform: scale(1.1);
    }
    
    /* الرسوم المتحركة */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideIn {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }
    
    /* تصميم متجاوب */
    @media (max-width: 768px) {
        .thumbnail-generator-container {
            padding: 15px;
        }
        
        .settings-tabs {
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .tab-btn {
            min-width: 100px;
            font-size: 14px;
            padding: 10px 12px;
        }
        
        .tb-buttons {
            flex-direction: column;
        }
        
        .color-picker-group {
            flex-direction: column;
        }
        
        .editor {
            gap: 20px;
        }
    }
</style>
</head>
<body>

<div class="heroBox">
    <div class="BoxTool">
        <div class="thumbnail-generator-container">
            <div class="container">
                <p class="title dt">
                    أداة مولد الصور المصغرة
                </p>
                
                <div class="editor">
                    <!-- قسم الإعدادات -->
                    <div class="tb-form-container">
                        <!-- تبويبات التنقل -->
                        <div class="settings-tabs" data-active-tab="1">
                            <button class="tab-btn active" data-tab="basic" onclick="setActiveTab(1)">
                                الأساسية
                            </button>
                            <button class="tab-btn" data-tab="design" onclick="setActiveTab(2)">
                                التصميم
                            </button>
                            <button class="tab-btn" data-tab="colors" onclick="setActiveTab(3)">
                                الألوان
                            </button>
                        </div>
                        
                        <!-- محتوى التبويبات -->
                        <div class="tab-content active" id="basic-tab">
                            <!-- قسم المعلومات الأساسية -->
                            <div class="form-section">
                                <p class="dt">
                                    المعلومات الأساسية
                                </p>
                                
                                <div class="form-group">
                                    <label for="title">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M12 20H21M3 20H4.67454C5.16372 20 5.40832 20 5.63849 19.9447C5.84256 19.8957 6.03765 19.8149 6.21693 19.7053C6.41843 19.5816 6.59138 19.4086 6.93729 19.0627L19.5 6.49998C20.3285 5.67156 20.3285 4.32841 19.5 3.49998C18.6716 2.67156 17.3285 2.67156 16.5 3.49998L3.93726 16.0627C3.59136 16.4086 3.4184 16.5816 3.29472 16.7831C3.18506 16.9624 3.10425 17.1574 3.05526 17.3615C3 17.5917 3 17.8363 3 18.3254V20Z"></path>
                                        </svg>
                                        عنوان المقال:
                                    </label>
                                    <input type="text" id="title" placeholder="أدخل العنوان هنا" />
                                </div>
                                
                                <div class="form-group">
                                    <label for="excerpt">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M7 8H17M7 12H17M7 16H13M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"></path>
                                        </svg>
                                        مقتطف المقال:
                                    </label>
                                    <textarea id="excerpt" placeholder="أدخل المقتطف هنا"></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="author">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z"></path>
                                            <path d="M16 15H8C5.79086 15 4 16.7909 4 19V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V19C20 16.7909 18.2091 15 16 15Z"></path>
                                        </svg>
                                        المؤلف:
                                    </label>
                                    <input type="text" id="author" placeholder="اسم المؤلف" />
                                </div>
                                
                                <div class="form-group">
                                    <label for="blogName">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                            <path d="M8 14C8 14 9.5 16 12 16C14.5 16 16 14 16 14"></path>
                                            <path d="M9 9H9.01"></path>
                                            <path d="M15 9H15.01"></path>
                                        </svg>
                                        اسم المدونة:
                                    </label>
                                    <input type="text" id="blogName" placeholder="اسم المدونة" />
                                </div>
                                
                                <div class="form-group">
                                    <label for="logo">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M4 16L9 11L13 15L20 8M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"></path>
                                        </svg>
                                        شعار المدونة:
                                    </label>
                                    <input type="file" id="logo" accept="image/*" />
                                </div>
                                
                                <div class="form-group">
                                    <label for="publishDate">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M3 9H21M7 3V5M17 3V5M6 12H8M11 12H13M16 12H18M6 15H8M11 15H13M16 15H18M6 18H8M11 18H13M16 18H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z"></path>
                                        </svg>
                                        تاريخ النشر:
                                    </label>
                                    <input type="date" id="publishDate" />
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="design-tab">
                            <!-- قسم إعدادات التصميم -->
                            <div class="form-section">
                                <p class="dt">
                                    إعدادات التصميم
                                </p>
                                
                                <div class="form-group">
                                    <label for="fontSelect">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M18 20V8M12 20V4M6 20V14"></path>
                                        </svg>
                                        نوع الخط:
                                    </label>
                                    <select id="fontSelect">
                                        <option value="El Messiri">El Messiri</option>
                                        <option value="Noto Kufi Arabic">Noto Kufi Arabic</option>
                                        <option value="Almarai">Almarai</option>
                                        <option value="Cairo">Cairo</option>
                                        <option value="Tajawal">Tajawal</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="aspectRatio">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M3 6H6V3M6 21H3V18M18 3V6H21M21 18V21H18M3 10V14M21 10V14M10 3H14M10 21H14M6 10V14M18 10V14M10 6H14V18H10V6Z"></path>
                                        </svg>
                                        نسبة الأبعاد:
                                    </label>
                                    <select id="aspectRatio">
                                        <option value="16/9">16:9 (أفقي)</option>
                                        <option value="4/3">4:3 (أفقي)</option>
                                        <option value="1/1">1:1 (مربع)</option>
                                        <option value="3/4">3:4 (رأسي)</option>
                                        <option value="9/16">9:16 (رأسي)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- قسم أحجام النصوص -->
                            <div class="form-section">
                                <p class="dt">
                                    أحجام النصوص
                                </p>
                                
                                <div class="size-control-group">
                                    <label for="titleSize">العنوان:</label>
                                    <div class="size-controls">
                                        <button class="size-btn minus-btn" data-target="titleSize">-</button>
                                        <span class="size-value" id="titleSizeValue">40px</span>
                                        <button class="size-btn plus-btn" data-target="titleSize">+</button>
                                    </div>
                                    <input type="hidden" id="titleSize" value="40">
                                </div>
                                
                                <div class="size-control-group">
                                    <label for="excerptSize">المقتطف:</label>
                                    <div class="size-controls">
                                        <button class="size-btn minus-btn" data-target="excerptSize">-</button>
                                        <span class="size-value" id="excerptSizeValue">26px</span>
                                        <button class="size-btn plus-btn" data-target="excerptSize">+</button>
                                    </div>
                                    <input type="hidden" id="excerptSize" value="26">
                                </div>
                                
                                <div class="size-control-group">
                                    <label for="authorSize">المؤلف:</label>
                                    <div class="size-controls">
                                        <button class="size-btn minus-btn" data-target="authorSize">-</button>
                                        <span class="size-value" id="authorSizeValue">15px</span>
                                        <button class="size-btn plus-btn" data-target="authorSize">+</button>
                                    </div>
                                    <input type="hidden" id="authorSize" value="15">
                                </div>
                                
                                <div class="size-control-group">
                                    <label for="blogNameSize">المدونة:</label>
                                    <div class="size-controls">
                                        <button class="size-btn minus-btn" data-target="blogNameSize">-</button>
                                        <span class="size-value" id="blogNameSizeValue">24px</span>
                                        <button class="size-btn plus-btn" data-target="blogNameSize">+</button>
                                    </div>
                                    <input type="hidden" id="blogNameSize" value="24">
                                </div>
                            </div>
                            
                            <!-- قسم خيارات الخلفية المعدل -->
                            <div class="form-section">
                                <p class="dt">
                                    خيارات الخلفية
                                </p>
                                
                                <div class="form-group">
                                    <label>
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                            <path d="M2 12H22"></path>
                                            <path d="M12 2C15.6 5 17 8.4 17 12C17 15.6 15.6 19 12 22C8.4 19 7 15.6 7 12C7 8.4 8.4 5 12 2Z"></path>
                                        </svg>
                                        نوع الخلفية:
                                    </label>
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="bgType" value="color" checked />
                                            <span>لون خلفية</span>
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="bgType" value="image" />
                                            <span>صورة خلفية</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group" id="bgImageGroup" style="display: none;">
                                    <label for="bgImage">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M4 16L9 11L13 15L20 8M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"></path>
                                        </svg>
                                        اختر صورة خلفية:
                                    </label>
                                    <input type="file" id="bgImage" accept="image/*" />
                                </div>
                                
                                <div class="form-group">
                                    <label for="bgColor">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                            <path d="M7 13L10 16L17 9"></path>
                                        </svg>
                                        لون الخلفية:
                                    </label>
                                    <input type="color" id="bgColor" value="#4361ee" />
                                </div>
                                
                                <div class="size-control-group">
                                    <label>شفافية الخلفية:</label>
                                    <div class="size-controls">
                                        <button class="size-btn minus-btn" data-target="bgOpacity">-</button>
                                        <span class="size-value" id="bgOpacityValue">90%</span>
                                        <button class="size-btn plus-btn" data-target="bgOpacity">+</button>
                                    </div>
                                    <input type="hidden" id="bgOpacity" value="90">
                                </div>
                            </div>
                            
                            <!-- قسم أنماط الزخرفة -->
                            <div class="form-section">
                                <p class="dt">
                                    نمط الزخرفة
                                </p>
                                
                                <div class="tb-pattern-options" id="patternOptions">
                                    <!-- الأنماط الأساسية -->
                                    <div class="tb-pattern-option selected" data-pattern="dots" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\' viewBox=\'0 0 100 100\'><circle cx=\'20\' cy=\'20\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'50\' cy=\'20\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'80\' cy=\'20\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'20\' cy=\'50\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'50\' cy=\'50\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'80\' cy=\'50\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'20\' cy=\'80\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'50\' cy=\'80\' r=\'2\' fill=\'%234361ee\'/><circle cx=\'80\' cy=\'80\' r=\'2\' fill=\'%234361ee\'/></svg>')"></div>
                                    <div class="tb-pattern-option" data-pattern="waves" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\' viewBox=\'0 0 100 100\'><path d=\'M0,50 C20,70 40,30 60,50 S80,30 100,50 L100,100 L0,100 Z\' fill=\'%234361ee\'/></svg>')"></div>
                                    <div class="tb-pattern-option" data-pattern="lines" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\' viewBox=\'0 0 100 100\'><line x1=\'0\' y1=\'20\' x2=\'100\' y2=\'20\' stroke=\'%234361ee\' stroke-width=\'1\'/><line x1=\'0\' y1=\'40\' x2=\'100\' y2=\'40\' stroke=\'%234361ee\' stroke-width=\'1\'/><line x1=\'0\' y1=\'60\' x2=\'100\' y2=\'60\' stroke=\'%234361ee\' stroke-width=\'1\'/><line x1=\'0\' y1=\'80\' x2=\'100\' y2=\'80\' stroke=\'%234361ee\' stroke-width=\'1\'/></svg>')"></div>
                                    <div class="tb-pattern-option" data-pattern="grid" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\' viewBox=\'0 0 100 100\'><path d=\'M 0 50 L 100 50 M 50 0 L 50 100\' stroke=\'%234361ee\' stroke-width=\'1\'/></svg>')"></div>
                                    <div class="tb-pattern-option" data-pattern="circles" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\' viewBox=\'0 0 100 100\'><circle cx=\'20\' cy=\'20\' r=\'10\' fill=\'none\' stroke=\'%234361ee\' stroke-width=\'1\'/><circle cx=\'80\' cy=\'20\' r=\'10\' fill=\'none\' stroke=\'%234361ee\' stroke-width=\'1\'/><circle cx=\'50\' cy=\'50\' r=\'10\' fill=\'none\' stroke=\'%234361ee\' stroke-width=\'1\'/><circle cx=\'20\' cy=\'80\' r=\'10\' fill=\'none\' stroke=\'%234361ee\' stroke-width=\'1\'/><circle cx=\'80\' cy=\'80\' r=\'10\' fill=\'none\' stroke=\'%234361ee\' stroke-width=\'1\'/></svg>')"></div>
                                    <div class="tb-pattern-option" data-pattern="none" style="background-color: #f5f5f5; display: flex; align-items: center; justify-content: center; font-size: 12px;">بدون</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="patternColor">
                                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                            <path d="M7 13L10 16L17 9"></path>
                                        </svg>
                                        لون النمط:
                                    </label>
                                    <input type="color" id="patternColor" value="#4361ee" />
                                </div>
                                
                                <div class="size-control-group">
                                    <label>شفافية النمط:</label>
                                    <div class="size-controls">
                                        <button class="size-btn minus-btn" data-target="patternOpacity">-</button>
                                        <span class="size-value" id="patternOpacityValue">20%</span>
                                        <button class="size-btn plus-btn" data-target="patternOpacity">+</button>
                                    </div>
                                    <input type="hidden" id="patternOpacity" value="20">
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="colors-tab">
                            <!-- قسم الألوان الموحد -->
                            <div class="form-section">
                                <p class="dt">
                                    الألوان
                                </p>
                                
                                <div class="color-sections">
                                    <!-- قسم ألوان النصوص -->
                                    <div class="color-section">
                                        <h4>ألوان النصوص</h4>
                                        <div class="color-grid">
                                            <div class="color-picker">
                                                <label for="titleColor">العنوان</label>
                                                <input type="color" id="titleColor" value="#333333" />
                                            </div>
                                            <div class="color-picker">
                                                <label for="excerptColor">المقتطف</label>
                                                <input type="color" id="excerptColor" value="#333333" />
                                            </div>
                                            <div class="color-picker">
                                                <label for="authorColor">المؤلف</label>
                                                <input type="color" id="authorColor" value="#333333" />
                                            </div>
                                            <div class="color-picker">
                                                <label for="blogNameColor">المدونة</label>
                                                <input type="color" id="blogNameColor" value="#333333" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- قسم الإنشاء والتحميل -->
                        <div class="form-section actions-section">
                            <p class="dt">
                                الإنشاء والتحميل
                            </p>
                            
                            <div class="tb-buttons">
                                <button id="generateBtn" class="tb-button primary-btn">
                                    <svg class="line" viewBox="0 0 24 24" width="18" height="18" style="margin-inline-end: 6px;">
                                        <path d="M9 10C10.1046 10 11 9.10457 11 8C11 6.89543 10.1046 6 9 6C7.89543 6 7 6.89543 7 8C7 9.10457 7.89543 10 9 10Z"></path>
                                        <path d="M13 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22H15C20 22 22 20 22 15V10"></path>
                                        <path d="M16 4.99005L17.46 6.45005L21.36 2.55005"></path>
                                        <path d="M2.67004 18.9501L7.60004 15.6401C8.39004 15.1101 9.53004 15.1701 10.24 15.7801L10.57 16.0701C11.35 16.7401 12.61 16.7401 13.39 16.0701L17.55 12.5001C18.33 11.8301 19.59 11.8301 20.37 12.5001L22 13.9001"></path>
                                    </svg>
                                    إنشاء الصورة
                                </button>
                                <button id="resetBtn" class="tb-button danger-btn">
                                    <svg class="line" viewBox="0 0 24 24" width="18" height="18" style="margin-inline-end: 6px;">
                                        <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 3.11 16.44 3.11 16.44M3.11 16.44H7.63M3.11 16.44V21.44M2 12C2 6.48 6.44 2 12 2C18.67 2 22 7.56 22 7.56M22 7.56V2.56M22 7.56H17.56"></path>
                                    </svg>
                                    إعادة التعيين
                                </button>
                            </div>
                            
                            <div class="tb-download-options">
                                <button id="downloadJpgBtn" class="tb-button secondary-btn">
                                    <svg class="line" viewBox="0 0 24 24" width="16" height="16" style="margin-inline-end: 6px;">
                                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                        <path d="M12 8.5V14.5"></path>
                                        <path d="M9 12.5L12 15.5L15 12.5"></path>
                                    </svg>
                                    JPG
                                </button>
                                <button id="downloadPngBtn" class="tb-button secondary-btn">
                                    <svg class="line" viewBox="0 0 24 24" width="16" height="16" style="margin-inline-end: 6px;">
                                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                        <path d="M12 8.5V14.5"></path>
                                        <path d="M9 12.5L12 15.5L15 12.5"></path>
                                    </svg>
                                    PNG
                                </button>
                                <button id="downloadWebpBtn" class="tb-button secondary-btn">
                                    <svg class="line" viewBox="0 0 24 24" width="16" height="16" style="margin-inline-end: 6px;">
                                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
                                        <path d="M12 8.5V14.5"></path>
                                        <path d="M9 12.5L12 15.5L15 12.5"></path>
                                    </svg>
                                    WebP
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- قسم المعاينة المحسّن -->
                    <div class="tb-preview">
                        <p class="title">المعاينة</p>
                        <div class="preview-container">
                            <div class="canvas-wrapper">
                                <canvas id="thumbnailCanvas" width="800" height="420"></canvas>
                                <div class="canvas-actions">
                                    <button class="canvas-action-btn" title="تدوير">
                                        <svg class='line' viewBox='0 0 24 24'><path d='M14.55 21.67C18.84 20.54 22 16.64 22 12C22 6.48 17.56 2 12 2C5.33 2 2 7.56 2 7.56M2 7.56V3M2 7.56H4.01H6.44'></path><path d='M2 12C2 17.52 6.48 22 12 22' stroke-dasharray='3 3'></path></svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="preview-controls">
                            <button class="preview-control-btn" title="إعادة تعيين">
                                <svg class='line' viewBox='0 0 22 22'><path d='M13.6 11.5799V14.3099C13.6 16.5899 12.69 17.4999 10.41 17.4999H7.69C5.42 17.4999 4.5 16.5899 4.5 14.3099V11.5799C4.5 9.3099 5.41 8.3999 7.69 8.3999H10.42C12.69 8.3999 13.6 9.3099 13.6 11.5799Z'></path><path d='M17.5 7.68V10.41C17.5 12.69 16.59 13.6 14.31 13.6H13.6V11.58C13.6 9.31 12.69 8.4 10.41 8.4H8.39999V7.68C8.39999 5.4 9.30999 4.5 11.59 4.5H14.32C16.59 4.5 17.5 5.41 17.5 7.68Z'></path><path d='M21 14C21 17.87 17.87 21 14 21L15.05 19.25'></path><path d='M1 8C1 4.13 4.13 1 8 1L6.95 2.75'></path></svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', function() {
  const canvas = document.getElementById('thumbnailCanvas');
  const ctx = canvas.getContext('2d');
  const titleInput = document.getElementById('title');
  const excerptInput = document.getElementById('excerpt');
  const authorInput = document.getElementById('author');
  const blogNameInput = document.getElementById('blogName');
  const logoInput = document.getElementById('logo');
  const bgColorInput = document.getElementById('bgColor');
  const generateBtn = document.getElementById('generateBtn');
  const downloadJpgBtn = document.getElementById('downloadJpgBtn');
  const downloadPngBtn = document.getElementById('downloadPngBtn');
  const downloadWebpBtn = document.getElementById('downloadWebpBtn');
  const resetBtn = document.getElementById('resetBtn');
  const patternOptions = document.getElementById('patternOptions');
  const aspectRatioSelect = document.getElementById('aspectRatio');
  const patternOpacityInput = document.getElementById('patternOpacity');
  const patternOpacityValue = document.getElementById('patternOpacityValue');
  const bgOpacityInput = document.getElementById('bgOpacity');
  const bgOpacityValue = document.getElementById('bgOpacityValue');
  const publishDateInput = document.getElementById('publishDate');
  const titleColorInput = document.getElementById('titleColor');
  const excerptColorInput = document.getElementById('excerptColor');
  const authorColorInput = document.getElementById('authorColor');
  const blogNameColorInput = document.getElementById('blogNameColor');
  const patternColorInput = document.getElementById('patternColor');
  const titleSizeInput = document.getElementById('titleSize');
  const titleSizeValue = document.getElementById('titleSizeValue');
  const excerptSizeInput = document.getElementById('excerptSize');
  const excerptSizeValue = document.getElementById('excerptSizeValue');
  const authorSizeInput = document.getElementById('authorSize');
  const authorSizeValue = document.getElementById('authorSizeValue');
  const blogNameSizeInput = document.getElementById('blogNameSize');
  const blogNameSizeValue = document.getElementById('blogNameSizeValue');
  const bgTypeRadios = document.querySelectorAll('input[name="bgType"]');
  const bgImageGroup = document.getElementById('bgImageGroup');
  const bgImageInput = document.getElementById('bgImage');
  
  // متغيرات الحالة
  let currentPattern = 'dots';
  let uploadedLogo = null;
  let uploadedBgImage = null;
  
  // تعيين تاريخ اليوم كقيمة افتراضية
  const today = new Date();
  const formattedDate = today.toISOString().split('T')[0];
  publishDateInput.value = formattedDate;

  // أنماط الزخرفة
  const patterns = {
    dots: `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'><circle cx='20' cy='20' r='2' fill='{color}'/><circle cx='50' cy='20' r='2' fill='{color}'/><circle cx='80' cy='20' r='2' fill='{color}'/><circle cx='20' cy='50' r='2' fill='{color}'/><circle cx='50' cy='50' r='2' fill='{color}'/><circle cx='80' cy='50' r='2' fill='{color}'/><circle cx='20' cy='80' r='2' fill='{color}'/><circle cx='50' cy='80' r='2' fill='{color}'/><circle cx='80' cy='80' r='2' fill='{color}'/></svg>`,
    waves: `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'><path d='M0,50 C20,70 40,30 60,50 S80,30 100,50 L100,100 L0,100 Z' fill='{color}'/></svg>`,
    lines: `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'><line x1='0' y1='20' x2='100' y2='20' stroke='{color}' stroke-width='1'/><line x1='0' y1='40' x2='100' y2='40' stroke='{color}' stroke-width='1'/><line x1='0' y1='60' x2='100' y2='60' stroke='{color}' stroke-width='1'/><line x1='0' y1='80' x2='100' y2='80' stroke='{color}' stroke-width='1'/></svg>`,
    grid: `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'><path d='M 0 50 L 100 50 M 50 0 L 50 100' stroke='{color}' stroke-width='1'/></svg>`,
    circles: `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'><circle cx='20' cy='20' r='10' fill='none' stroke='{color}' stroke-width='1'/><circle cx='80' cy='20' r='10' fill='none' stroke='{color}' stroke-width='1'/><circle cx='50' cy='50' r='10' fill='none' stroke='{color}' stroke-width='1'/><circle cx='20' cy='80' r='10' fill='none' stroke='{color}' stroke-width='1'/><circle cx='80' cy='80' r='10' fill='none' stroke='{color}' stroke-width='1'/></svg>`,
    none: 'none'
  };

  // أحداث التحكم في الحجم
  document.querySelectorAll('.plus-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const targetId = this.dataset.target;
      const input = document.getElementById(targetId);
      const valueSpan = document.getElementById(`${targetId}Value`);
      
      let currentValue = parseInt(input.value);
      let newValue = currentValue + 1;
      
      // تحديد الحد الأقصى لكل عنصر
      let maxValue;
      switch(targetId) {
        case 'titleSize': maxValue = 60; break;
        case 'excerptSize': maxValue = 36; break;
        case 'authorSize': maxValue = 24; break;
        case 'blogNameSize': maxValue = 30; break;
        case 'bgOpacity': maxValue = 100; break;
        case 'patternOpacity': maxValue = 100; break;
        default: maxValue = 100;
      }
      
      if (newValue <= maxValue) {
        input.value = newValue;
        valueSpan.textContent = `${newValue}${targetId.includes('Opacity') ? '%' : 'px'}`;
        generateThumbnail();
      }
    });
  });

  document.querySelectorAll('.minus-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const targetId = this.dataset.target;
      const input = document.getElementById(targetId);
      const valueSpan = document.getElementById(`${targetId}Value`);
      
      let currentValue = parseInt(input.value);
      let newValue = currentValue - 1;
      
      // تحديد الحد الأدنى لكل عنصر
      let minValue;
      switch(targetId) {
        case 'titleSize': minValue = 20; break;
        case 'excerptSize': minValue = 16; break;
        case 'authorSize': minValue = 12; break;
        case 'blogNameSize': minValue = 12; break;
        case 'bgOpacity': minValue = 0; break;
        case 'patternOpacity': minValue = 0; break;
        default: minValue = 0;
      }
      
      if (newValue >= minValue) {
        input.value = newValue;
        valueSpan.textContent = `${newValue}${targetId.includes('Opacity') ? '%' : 'px'}`;
        generateThumbnail();
      }
    });
  });

  // استماع لاختيار النمط
  patternOptions.addEventListener('click', function(e) {
    const patternOption = e.target.closest('.tb-pattern-option');
    if (patternOption) {
      document.querySelectorAll('.tb-pattern-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      patternOption.classList.add('selected');
      currentPattern = patternOption.dataset.pattern;
      generateThumbnail();
    }
  });

  // استماع لتغيير نوع الخلفية
  bgTypeRadios.forEach(radio => {
    radio.addEventListener('change', function() {
      if (this.value === 'image') {
        bgImageGroup.style.display = 'block';
      } else {
        bgImageGroup.style.display = 'none';
      }
      generateThumbnail();
    });
  });

  // استماع لرفع صورة الخلفية
  bgImageInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(event) {
        uploadedBgImage = new Image();
        uploadedBgImage.onload = function() {
          generateThumbnail();
        };
        uploadedBgImage.src = event.target.result;
      };
      reader.readAsDataURL(file);
    }
  });

  // استماع لرفع الشعار
  logoInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(event) {
        uploadedLogo = new Image();
        uploadedLogo.onload = function() {
          generateThumbnail();
        };
        uploadedLogo.src = event.target.result;
      };
      reader.readAsDataURL(file);
    }
  });

  // أحداث الأزرار
  generateBtn.addEventListener('click', generateThumbnail);
  downloadJpgBtn.addEventListener('click', () => downloadThumbnail('jpg'));
  downloadPngBtn.addEventListener('click', () => downloadThumbnail('png'));
  downloadWebpBtn.addEventListener('click', () => downloadThumbnail('webp'));
  resetBtn.addEventListener('click', resetSettings);

  // تحديث حجم الكانفاس بناءً على نسبة الأبعاد
  function updateCanvasSize() {
    const ratio = aspectRatioSelect.value;
    const [widthRatio, heightRatio] = ratio.split('/').map(Number);
    const newWidth = 800;
    const newHeight = Math.round(newWidth * heightRatio / widthRatio);
    canvas.width = newWidth;
    canvas.height = newHeight;
  }

  // إعادة تعيين الإعدادات
  function resetSettings() {
    titleInput.value = '';
    excerptInput.value = '';
    authorInput.value = '';
    blogNameInput.value = '';
    logoInput.value = '';
    bgColorInput.value = '#4a6fa5';
    titleColorInput.value = '#333333';
    excerptColorInput.value = '#333333';
    authorColorInput.value = '#333333';
    blogNameColorInput.value = '#333333';
    patternColorInput.value = '#4a6fa5';
    
    // إعادة تعيين أحجام النصوص
    titleSizeInput.value = 40;
    excerptSizeInput.value = 26;
    authorSizeInput.value = 15;
    blogNameSizeInput.value = 24;
    titleSizeValue.textContent = '40px';
    excerptSizeValue.textContent = '26px';
    authorSizeValue.textContent = '15px';
    blogNameSizeValue.textContent = '24px';
    
    // إعادة تعيين الشفافية
    patternOpacityInput.value = 20;
    patternOpacityValue.textContent = '20%';
    bgOpacityInput.value = 90;
    bgOpacityValue.textContent = '90%';
    
    // إعادة تعيين الخيارات
    document.getElementById('fontSelect').selectedIndex = 0;
    aspectRatioSelect.selectedIndex = 0;
    
    // إعادة تعيين نوع الخلفية
    document.querySelector('input[name="bgType"][value="color"]').checked = true;
    bgImageGroup.style.display = 'none';
    bgImageInput.value = '';
    
    // إعادة تعيين النمط
    currentPattern = 'dots';
    document.querySelectorAll('.tb-pattern-option').forEach(opt => {
      opt.classList.remove('selected');
    });
    document.querySelector('.tb-pattern-option[data-pattern="dots"]').classList.add('selected');
    
    // إعادة تعيين الصور
    uploadedLogo = null;
    uploadedBgImage = null;
    
    // تعيين تاريخ اليوم
    publishDateInput.value = formattedDate;
    
    // تحديث الحجم وإعادة التوليد
    updateCanvasSize();
    generateThumbnail();
  }

  // توليد الصورة المصغرة
  function generateThumbnail() {
    const title = titleInput.value || "عنوان المقال";
    const excerpt = excerptInput.value || "مقتطف المقال يظهر هنا...";
    const author = authorInput.value || "اسم المؤلف";
    const blogName = blogNameInput.value || "اسم المدونة";
    const bgColor = bgColorInput.value;
    const patternColor = patternColorInput.value;
    const selectedFont = document.getElementById('fontSelect').value;
    const patternOpacity = patternOpacityInput.value / 100;
    const bgOpacity = bgOpacityInput.value / 100;
    const titleColor = titleColorInput.value;
    const excerptColor = excerptColorInput.value;
    const authorColor = authorColorInput.value;
    const blogNameColor = blogNameColorInput.value;
    const titleSize = parseInt(titleSizeInput.value);
    const excerptSize = parseInt(excerptSizeInput.value);
    const authorSize = parseInt(authorSizeInput.value);
    const blogNameSize = parseInt(blogNameSizeInput.value);
    const bgType = document.querySelector('input[name="bgType"]:checked').value;
    
    // تنسيق التاريخ
    const publishDate = new Date(publishDateInput.value);
    const arabicDate = formatArabicDate(publishDate);

    // مسح الكانفاس
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 1. رسم الخلفية الأساسية (لون/صورة)
    if (bgType === 'color') {
      // خلفية لونية
      ctx.save();
      ctx.globalAlpha = bgOpacity;
      ctx.fillStyle = lightenColor(bgColor, 90);
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.restore();
    } else if (bgType === 'image' && uploadedBgImage) {
      // خلفية صورة
      ctx.save();
      ctx.globalAlpha = bgOpacity;
      ctx.drawImage(uploadedBgImage, 0, 0, canvas.width, canvas.height);
      
      // تطبيق تأثير اللون
      ctx.fillStyle = patternColor;
      ctx.globalCompositeOperation = 'overlay';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.restore();
    }

    // 2. رسم الأنماط الزخرفية
    if (currentPattern !== 'none') {
      const patternImg = new Image();
      patternImg.onload = function() {
        const pattern = ctx.createPattern(patternImg, 'repeat');
        ctx.save();
        ctx.globalAlpha = patternOpacity;
        ctx.fillStyle = pattern;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.restore();
        drawContent();
      };
      const patternWithColor = patterns[currentPattern].replace(/{color}/g, encodeURIComponent(patternColor));
      patternImg.src = patternWithColor;
    } else {
      drawContent();
    }

    function drawContent() {
      // رسم الشعار واسم المدونة إذا كانا موجودين
      if (uploadedLogo) {
        const logoSize = 60;
        const logoX = canvas.width - logoSize - 30; // نقل لليمين
        const logoY = 30;
        
        // تأثير ظل للشعار
        ctx.save();
        ctx.beginPath();
        ctx.arc(logoX + logoSize/2, logoY + logoSize/2, logoSize/2 + 5, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
        ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
        ctx.shadowBlur = 10;
        ctx.shadowOffsetY = 5;
        ctx.fill();
        ctx.restore();
        
        // رسم الشعار
        ctx.drawImage(uploadedLogo, logoX, logoY, logoSize, logoSize);
        
        // اسم المدونة (على يسار الشعار الآن)
        ctx.font = `bold ${blogNameSize}px ${selectedFont}`;
        ctx.fillStyle = blogNameColor;
        ctx.textAlign = 'right'; // تغيير المحاذاة لليمين
        ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
        ctx.shadowBlur = 5;
        
        const maxBlogNameWidth = 400;
        const blogNameMetrics = ctx.measureText(blogName);
        
        if (blogNameMetrics.width > maxBlogNameWidth) {
          // إذا كان اسم المدونة طويلاً، نقسمه إلى سطرين
          const words = blogName.split(' ');
          let line1 = '';
          let line2 = '';
          let part = 0;
          
          for (let i = 0; i < words.length; i++) {
            const testLine = (part === 0 ? line1 : line2) + words[i] + ' ';
            const testWidth = ctx.measureText(testLine).width;
            
            if (testWidth <= maxBlogNameWidth) {
              if (part === 0) {
                line1 = testLine;
              } else {
                line2 = testLine;
              }
            } else {
              if (part === 0) {
                part = 1;
                line2 = words[i] + ' ';
              } else {
                break;
              }
            }
          }
          
          ctx.fillText(line1.trim(), logoX - 20, logoY + logoSize/2);
          ctx.fillText(line2.trim(), logoX - 20, logoY + logoSize/2 + blogNameSize + 5);
        } else {
          ctx.fillText(blogName, logoX - 20, logoY + logoSize/2 + 10);
        }
      } else if (blogName) {
        // إذا لم يكن هناك شعار ولكن هناك اسم مدونة
        ctx.font = `bold ${blogNameSize}px ${selectedFont}`;
        ctx.fillStyle = blogNameColor;
        ctx.textAlign = 'right';
        ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
        ctx.shadowBlur = 5;
        ctx.fillText(blogName, canvas.width - 30, 70);
      }

      // رسم معلومات المؤلف والتاريخ
      ctx.font = `italic ${authorSize}px ${selectedFont}`;
      ctx.fillStyle = authorColor;
      ctx.textAlign = 'left';
      ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
      ctx.shadowBlur = 1;
      
      const authorX = canvas.width - 250;
      const authorY = canvas.height - 40;
      
      // أيقونة المؤلف
      ctx.save();
      ctx.font = `16px 'Segoe UI Emoji', 'Noto Color Emoji'`;
      ctx.fillText('👤', authorX - 25, authorY);
      ctx.restore();
      
      // اسم المؤلف
      ctx.fillText(author, authorX, authorY);
      
      // أيقونة التاريخ
      ctx.save();
      ctx.font = `16px 'Segoe UI Emoji', 'Noto Color Emoji'`;
      ctx.fillText('🗓', authorX + ctx.measureText(author).width + 20, authorY);
      ctx.restore();
      
      // تاريخ النشر
      ctx.fillText(arabicDate, authorX + ctx.measureText(author).width + 42, authorY);

      // رسم عنوان المقال
      ctx.fillStyle = titleColor;
      ctx.font = `bold ${titleSize}px ${selectedFont}`;
      ctx.textAlign = 'right';
      ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
      ctx.shadowBlur = 8;
      ctx.shadowOffsetY = 3;

      const titleX = canvas.width - 60;
      const titleY = 160;
      const titleLineHeight = titleSize + 10;
      const titleHeight = wrapTitleText(ctx, title, titleX, titleY, canvas.width - 110, titleLineHeight);

      // رسم مقتطف المقال
      ctx.fillStyle = excerptColor;
      ctx.font = `${excerptSize}px ${selectedFont}`;
      ctx.textAlign = 'right';
      ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
      ctx.shadowBlur = 3;

      const excerptX = canvas.width - 60;
      const excerptMaxWidth = canvas.width - 120;
      const excerptStartY = titleY + titleHeight + 20;
      wrapTextModern(ctx, excerpt, excerptX, excerptStartY, excerptMaxWidth, excerptSize + 6);
    }
  }

  // دالة لتفكيك النص إلى أسطر
  function wrapTitleText(ctx, text, x, y, maxWidth, lineHeight = 40, maxLines = 2) {
    const words = text.split(' ');
    const lines = [];
    let currentLine = words[0] || '';

    for (let i = 1; i < words.length; i++) {
      const testLine = currentLine + ' ' + words[i];
      const testWidth = ctx.measureText(testLine).width;

      if (testWidth <= maxWidth && lines.length < maxLines - 1) {
        currentLine = testLine;
      } else {
        lines.push(currentLine);
        currentLine = words[i];

        // إذا وصلنا للسطر الأخير (الثاني)
        if (lines.length === maxLines - 1) {
          let finalLine = currentLine;

          // إجبار ظهور النقاط دائمًا بالسطر الثاني
          while (ctx.measureText(finalLine + '...').width > maxWidth && finalLine.length > 0) {
            finalLine = finalLine.slice(0, -1);
          }

          lines.push(finalLine + '...');
          break;
        }
      }
    }

    if (lines.length < maxLines && currentLine && !lines.includes(currentLine)) {
      lines.push(currentLine);
    }

    // رسم الأسطر: السطر الأول يبقى في مكانه، وإذا سطرين يتم تحريكهما للأعلى قليلاً
    const totalLines = lines.length;
    const offsetY = totalLines === 2 ? lineHeight / 2 : 0;
    const startY = y - offsetY;

    for (let i = 0; i < totalLines; i++) {
      ctx.fillText(lines[i], x, startY + (i * lineHeight));
    }

    return totalLines * lineHeight;
  }

  // دالة لتفكيك المقتطف إلى أسطر
  function wrapTextModern(context, text, x, y, maxWidth, lineHeight = 30) {
    const words = text.split(' ');
    let lines = [];
    let currentLine = words[0];

    for (let i = 1; i < words.length; i++) {
      const word = words[i];
      const testLine = currentLine + ' ' + word;
      const metrics = context.measureText(testLine);

      if (metrics.width <= maxWidth) {
        currentLine = testLine;
      } else {
        lines.push(currentLine);
        currentLine = word;
      }
    }
    lines.push(currentLine);

    // تحديد عدد الأسطر المسموح به (4 أسطر كحد أقصى)
    const maxVisibleLines = 4;
    const visibleLines = lines.slice(0, maxVisibleLines);
    
    // إذا كان النص أطول من المسموح، نضيف نقاط في النهاية
    if (lines.length > maxVisibleLines) {
      let lastLine = visibleLines[visibleLines.length - 1];
      while (context.measureText(lastLine + '...').width > maxWidth && lastLine.length > 0) {
        lastLine = lastLine.slice(0, -1);
      }
      visibleLines[visibleLines.length - 1] = lastLine + '...';
    }

    for (let i = 0; i < visibleLines.length; i++) {
      context.fillText(visibleLines[i], x, y + (i * lineHeight));
    }
  }

  // تنسيق التاريخ العربي
  function formatArabicDate(date) {
    if (isNaN(date.getTime())) return 'تاريخ غير محدد';
    
    const arabicMonths = [
      'يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو',
      'يوليو', 'أغسطس', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'
    ];
    
    const day = date.getDate();
    const month = arabicMonths[date.getMonth()];
    const year = date.getFullYear();
    
    return `${day} ${month} ${year}`;
  }

  // تحميل الصورة المصغرة
  function downloadThumbnail(format = 'png') {
    let mimeType, fileExtension;
    
    switch (format) {
      case 'jpg':
        mimeType = 'image/jpeg';
        fileExtension = 'jpg';
        break;
      case 'png':
        mimeType = 'image/png';
        fileExtension = 'png';
        break;
      case 'webp':
        mimeType = 'image/webp';
        fileExtension = 'webp';
        break;
      default:
        mimeType = 'image/png';
        fileExtension = 'png';
    }
    
    const link = document.createElement('a');
    link.download = `thumbnail-${Date.now()}.${fileExtension}`;
    link.href = canvas.toDataURL(mimeType, 0.9);
    link.click();
  }

  // تفتيح اللون
  function lightenColor(color, percent) {
    const num = parseInt(color.replace('#', ''), 16);
    const amt = Math.round(2.55 * percent);
    const R = (num >> 16) + amt;
    const G = (num >> 8 & 0x00FF) + amt;
    const B = (num & 0x0000FF) + amt;
    
    return '#' + (
      0x1000000 +
      (R < 255 ? (R < 1 ? 0 : R) : 255) * 0x10000 +
      (G < 255 ? (G < 1 ? 0 : G) : 255) * 0x100 +
      (B < 255 ? (B < 1 ? 0 : B) : 255)
    ).toString(16).slice(1);
  }

  // تهيئة الحجم الأولي وتوليد الصورة
  updateCanvasSize();
  generateThumbnail();
});
</script>

<script>
        // دالة لتعيين التبويب النشط
        function setActiveTab(tabNumber) {
            const tabsContainer = document.querySelector('.settings-tabs');
            tabsContainer.setAttribute('data-active-tab', tabNumber);
            
            // تحديث الأزرار النشطة
            document.querySelectorAll('.tab-btn').forEach((btn, index) => {
                if (index === tabNumber - 1) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // تحديث المحتوى النشط
            document.querySelectorAll('.tab-content').forEach((content, index) => {
                if (index === tabNumber - 1) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }
        
        // إدارة أحداث التبويبات
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const tabId = e.currentTarget.getAttribute('data-tab');
                
                // إخفاء جميع محتويات التبويبات
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // إظهار محتوى التبويب المحدد
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
    </script>
    </body>
</html>
